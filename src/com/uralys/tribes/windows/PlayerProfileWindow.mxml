<?xml version="1.0" encoding="utf-8"?>
<windows:ResizableTitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" 
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   xmlns:windows="com.uralys.tribes.windows.*"
			   skinClass="com.uralys.tribes.skins.WindowSkin"
			   close="{closeWindow()}"
			   width="340"
			   height="560"
			   backgroundAlpha="0.7"
			   backgroundColor="#000000"
			   cornerRadius="15"
			   >
	
	
	<fx:Script>
		<![CDATA[
			import com.uralys.tribes.commons.Numbers;
			import com.uralys.tribes.commons.Session;
			import com.uralys.tribes.commons.Translations;
			import com.uralys.tribes.entities.City;
			import com.uralys.tribes.managers.GameManager;
			
			import mx.controls.SWFLoader;
			import mx.core.FlexGlobals;
			import mx.events.ItemClickEvent;
			import mx.managers.PopUpManager;

			//-----------------------------------------------------------------//
			
			public var playerUID:String;
			
			//-----------------------------------------------------------------//

			private var loadingFlash:SWFLoader;

			//-----------------------------------------------------------------//
			
			public function closeWindow():void{
				PopUpManager.removePopUp(this);
			}
			
			//-----------------------------------------------------------------//
			
			public function refresh():void{
				GameManager.getInstance().getPlayer(playerUID);
			}

			//-----------------------------------------------------------------//

			public var editProfileWindow:EditPlayerProfileWindow = new EditPlayerProfileWindow();
			private function openEditProfile():void{
				editProfileWindow.closeWindow();
					
				PopUpManager.addPopUp(editProfileWindow, FlexGlobals.topLevelApplication.window, true);
				PopUpManager.centerPopUp(editProfileWindow);
			}
			
			//-------------------------------------------------------------------------//
			
			public var messageWindow:MessageWindow = new MessageWindow();
			private function openWriteMessage():void
			{
				messageWindow.closeWindow(); 
				
				PopUpManager.addPopUp(messageWindow, FlexGlobals.topLevelApplication.window, false);
				PopUpManager.centerPopUp(messageWindow);
			}
			
		]]>
	</fx:Script>
	
	<s:Group width="100%" height="100%">
		
		<s:VGroup horizontalAlign="center" top="5" width="100%">
			<mx:SWFLoader source="{ImageContainer.LOADING}" 
						  visible="{Session.WAIT_FOR_SERVER}"/>
			<s:HGroup>
				<s:Label text="{Session.playerLoaded.name}" color="#ffffff" fontSize="26"/>
				<mx:Image source="{ImageContainer.getImage(ImageContainer.EDIT_WHITE)}"
						  click="openWriteMessage()"
						  visible="{Session.LOGGED_IN &amp;&amp; Session.player.playerUID != Session.playerLoaded.playerUID}"
						  includeInLayout="{Session.LOGGED_IN &amp;&amp; Session.player.playerUID != Session.playerLoaded.playerUID}"/>
			</s:HGroup>
			
			<s:Label text="{Translations.CITIES.getItemAt(Session.LANGUAGE)} : {Session.playerLoaded.nbCities}" color="#ffffff"/>
			<s:Label text="{Translations.ARMIES.getItemAt(Session.LANGUAGE)} : {Session.playerLoaded.nbArmies}" color="#ffffff"/>
			<s:Label text="{Translations.LANDS.getItemAt(Session.LANGUAGE)} : {Session.playerLoaded.nbLands}" color="#ffffff"/>
			<s:Label text="{Translations.POPULATION.getItemAt(Session.LANGUAGE)} : {Session.playerLoaded.nbPopulation}" color="#ffffff"/>
			<s:HGroup>
				<s:Label text="{Translations.PROFILE.getItemAt(Session.LANGUAGE)}" color="#ffffff"/>
				<mx:Image source="{ImageContainer.getImage(ImageContainer.EDIT_WHITE)}"
						  click="openEditProfile()"
						  visible="{Session.LOGGED_IN &amp;&amp; Session.player.playerUID == Session.playerLoaded.playerUID}"
						  includeInLayout="{Session.LOGGED_IN &amp;&amp; Session.player.playerUID == Session.playerLoaded.playerUID}"
						  />
			</s:HGroup>
			<s:Label text="{Session.playerLoaded.profile}" color="#ffffff"/>
			
		</s:VGroup>
		
	</s:Group>
	
</windows:ResizableTitleWindow>
